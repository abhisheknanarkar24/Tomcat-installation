#####################################################################################
# Date            Version            Change
# 01/03/2019      1.0                created (previous)
# 11/04/2019      2.0                backlog fixes and new features (current)
#####################################################################################
---

- set_fact:
    port: "{{ tomcat_port }}"

- name: Verify if service exists
  win_command: C:/Windows/System32/sc query "{{ service_name }}-{{ port }}"
  register: result
  ignore_errors: true

- name: "Unzip tomcat {{ port }}"
  win_unzip:
    src: "{{ software_dir }}\\{{ tomcat_zip }}"
    dest: "{{ tomcat_dir }}-{{ tomcat_version }}-{{ port }}"
    delete_unarchive: no
  when: "'FAILED' in result.stdout"
